<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ResourceMapping.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">jacocoReport</a> &gt; <a href="index.source.html" class="el_package">net.sf.freecol.common.resources</a> &gt; <span class="el_source">ResourceMapping.java</span></div><h1>ResourceMapping.java</h1><pre class="source lang-java linenums">/**
 *  Copyright (C) 2002-2015   The FreeCol Team
 *
 *  This file is part of FreeCol.
 *
 *  FreeCol is free software: you can redistribute it and/or modify
 *  it under the terms of the GNU General Public License as published by
 *  the Free Software Foundation, either version 2 of the License, or
 *  (at your option) any later version.
 *
 *  FreeCol is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *  GNU General Public License for more details.
 *
 *  You should have received a copy of the GNU General Public License
 *  along with FreeCol.  If not, see &lt;http://www.gnu.org/licenses/&gt;.
 */

package net.sf.freecol.common.resources;

import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.Set;
import java.util.logging.Logger;
import java.util.stream.Collectors;

/**
 * Represents a mapping between identifiers and resources.
 *
 * @see Resource
 */
public final class ResourceMapping {

	/** The Constant logger. */
<span class="fc" id="L37">	private static final Logger logger = Logger.getLogger(ResourceMapping.class.getName());</span>

	/** Mappings between an object identifier and a resource. */
	private final HashMap&lt;String, ColorResource&gt; colorResources;

	/** The font resources. */
	private final HashMap&lt;String, FontResource&gt; fontResources;

	/** The string resources. */
	private final HashMap&lt;String, StringResource&gt; stringResources;

	/** The faf resources. */
	private final HashMap&lt;String, FAFileResource&gt; fafResources;

	/** The sza resources. */
	private final HashMap&lt;String, SZAResource&gt; szaResources;

	/** The audio resources. */
	private final HashMap&lt;String, AudioResource&gt; audioResources;

	/** The video resources. */
	private final HashMap&lt;String, VideoResource&gt; videoResources;

	/** The image resources. */
	private final HashMap&lt;String, ImageResource&gt; imageResources;

	/**
	 * Creates a new empty &lt;code&gt;ResourceMapping&lt;/code&gt;.
	 */
<span class="fc" id="L66">	public ResourceMapping() {</span>
<span class="fc" id="L67">		colorResources = new HashMap&lt;&gt;();</span>
<span class="fc" id="L68">		fontResources = new HashMap&lt;&gt;();</span>
<span class="fc" id="L69">		stringResources = new HashMap&lt;&gt;();</span>
<span class="fc" id="L70">		fafResources = new HashMap&lt;&gt;();</span>
<span class="fc" id="L71">		szaResources = new HashMap&lt;&gt;();</span>
<span class="fc" id="L72">		audioResources = new HashMap&lt;&gt;();</span>
<span class="fc" id="L73">		videoResources = new HashMap&lt;&gt;();</span>
<span class="fc" id="L74">		imageResources = new HashMap&lt;&gt;();</span>
<span class="fc" id="L75">	}</span>

	// TODO: Consider cutting off the type prefixes after validation,
	// to reduce processing time and memory use for strings.

	/**
	 * Adds a mapping between the given object identifier and a
	 * &lt;code&gt;Resource&lt;/code&gt;.
	 *
	 * @param key
	 *            The identifier for the given resource in the mapping.
	 * @param value
	 *            The &lt;code&gt;Resource&lt;/code&gt; identified by the identifier in the
	 *            mapping,.
	 * @return true on success
	 */
	public boolean add(String key, ColorResource value) {
<span class="pc bpc" id="L92" title="1 of 2 branches missed.">		if (!key.startsWith(&quot;color.&quot;)) {</span>
<span class="nc" id="L93">			logger.warning(&quot;Rejecting malformed resource key: &quot; + key);</span>
<span class="nc" id="L94">			return false;</span>
		}
<span class="fc" id="L96">		colorResources.put(key, value);</span>
<span class="fc" id="L97">		return true;</span>
	}

	/**
	 * Adds the.
	 *
	 * @param key
	 *            the key
	 * @param value
	 *            the value
	 * @return true, if successful
	 */
	public boolean add(String key, FontResource value) {
<span class="pc bpc" id="L110" title="1 of 2 branches missed.">		if (!key.startsWith(&quot;font.&quot;)) {</span>
<span class="nc" id="L111">			logger.warning(&quot;Rejecting malformed resource key: &quot; + key);</span>
<span class="nc" id="L112">			return false;</span>
		}
<span class="fc" id="L114">		fontResources.put(key, value);</span>
<span class="fc" id="L115">		return true;</span>
	}

	/**
	 * Adds the.
	 *
	 * @param key
	 *            the key
	 * @param value
	 *            the value
	 * @return true, if successful
	 */
	public boolean add(String key, StringResource value) {
<span class="fc" id="L128">		stringResources.put(key, value);</span>
<span class="fc" id="L129">		return true;</span>
	}

	/**
	 * Adds the.
	 *
	 * @param key
	 *            the key
	 * @param value
	 *            the value
	 * @return true, if successful
	 */
	public boolean add(String key, FAFileResource value) {
<span class="pc bpc" id="L142" title="1 of 2 branches missed.">		if (!key.startsWith(&quot;animatedfont.&quot;)) {</span>
<span class="nc" id="L143">			logger.warning(&quot;Rejecting malformed resource key: &quot; + key);</span>
<span class="nc" id="L144">			return false;</span>
		}
<span class="fc" id="L146">		fafResources.put(key, value);</span>
<span class="fc" id="L147">		return true;</span>
	}

	/**
	 * Adds the.
	 *
	 * @param key
	 *            the key
	 * @param value
	 *            the value
	 * @return true, if successful
	 */
	public boolean add(String key, SZAResource value) {
<span class="pc bpc" id="L160" title="1 of 2 branches missed.">		if (!key.startsWith(&quot;animation.&quot;)) {</span>
<span class="nc" id="L161">			logger.warning(&quot;Rejecting malformed resource key: &quot; + key);</span>
<span class="nc" id="L162">			return false;</span>
		}
<span class="fc" id="L164">		szaResources.put(key, value);</span>
<span class="fc" id="L165">		return true;</span>
	}

	/**
	 * Adds the.
	 *
	 * @param key
	 *            the key
	 * @param value
	 *            the value
	 * @return true, if successful
	 */
	public boolean add(String key, AudioResource value) {
<span class="pc bpc" id="L178" title="1 of 2 branches missed.">		if (!key.startsWith(&quot;sound.&quot;)) {</span>
<span class="nc" id="L179">			logger.warning(&quot;Rejecting malformed resource key: &quot; + key);</span>
<span class="nc" id="L180">			return false;</span>
		}
<span class="fc" id="L182">		audioResources.put(key, value);</span>
<span class="fc" id="L183">		return true;</span>
	}

	/**
	 * Adds the.
	 *
	 * @param key
	 *            the key
	 * @param value
	 *            the value
	 * @return true, if successful
	 */
	public boolean add(String key, VideoResource value) {
<span class="pc bpc" id="L196" title="1 of 2 branches missed.">		if (!key.startsWith(&quot;video.&quot;)) {</span>
<span class="nc" id="L197">			logger.warning(&quot;Rejecting malformed resource key: &quot; + key);</span>
<span class="nc" id="L198">			return false;</span>
		}
<span class="fc" id="L200">		videoResources.put(key, value);</span>
<span class="fc" id="L201">		return true;</span>
	}

	/**
	 * Adds the.
	 *
	 * @param key
	 *            the key
	 * @param value
	 *            the value
	 * @return true, if successful
	 */
	public boolean add(String key, ImageResource value) {
<span class="pc bpc" id="L214" title="1 of 2 branches missed.">		if (!key.startsWith(&quot;image.&quot;)) {</span>
<span class="nc" id="L215">			logger.warning(&quot;Rejecting malformed resource key: &quot; + key);</span>
<span class="nc" id="L216">			return false;</span>
		}
<span class="fc" id="L218">		imageResources.put(key, value);</span>
<span class="fc" id="L219">		return true;</span>
	}

	/**
	 * Create another mapping for a Resource under a different key.
	 *
	 * @param key
	 *            The key to find the existing Resource.
	 * @param keyNew
	 *            The new key for the duplicate.
	 * @return true on success
	 */
	public boolean duplicateResource(String key, String keyNew) {
<span class="fc" id="L232">		ColorResource cr = colorResources.get(key);</span>
<span class="pc bpc" id="L233" title="1 of 2 branches missed.">		if (cr != null) {</span>
<span class="nc" id="L234">			return add(keyNew, cr);</span>
		}
<span class="fc" id="L236">		FontResource fr = fontResources.get(key);</span>
<span class="pc bpc" id="L237" title="1 of 2 branches missed.">		if (fr != null) {</span>
<span class="nc" id="L238">			return add(keyNew, fr);</span>
		}
<span class="fc" id="L240">		StringResource sr = stringResources.get(key);</span>
<span class="pc bpc" id="L241" title="1 of 2 branches missed.">		if (sr != null) {</span>
<span class="nc" id="L242">			return add(keyNew, sr);</span>
		}
<span class="fc" id="L244">		FAFileResource far = fafResources.get(key);</span>
<span class="pc bpc" id="L245" title="1 of 2 branches missed.">		if (far != null) {</span>
<span class="nc" id="L246">			return add(keyNew, far);</span>
		}
<span class="fc" id="L248">		SZAResource szr = szaResources.get(key);</span>
<span class="pc bpc" id="L249" title="1 of 2 branches missed.">		if (szr != null) {</span>
<span class="nc" id="L250">			return add(keyNew, szr);</span>
		}
<span class="fc" id="L252">		AudioResource ar = audioResources.get(key);</span>
<span class="pc bpc" id="L253" title="1 of 2 branches missed.">		if (ar != null) {</span>
<span class="nc" id="L254">			return add(keyNew, ar);</span>
		}
<span class="fc" id="L256">		VideoResource vr = videoResources.get(key);</span>
<span class="pc bpc" id="L257" title="1 of 2 branches missed.">		if (vr != null) {</span>
<span class="nc" id="L258">			return add(keyNew, vr);</span>
		}
<span class="fc" id="L260">		ImageResource ir = imageResources.get(key);</span>
<span class="pc bpc" id="L261" title="1 of 2 branches missed.">		if (ir != null) {</span>
<span class="fc" id="L262">			return add(keyNew, ir);</span>
		}
<span class="nc" id="L264">		return false;</span>
	}

	/**
	 * Adds all mappings from the given &lt;code&gt;ResourceMapping&lt;/code&gt; to this
	 * object.
	 *
	 * @param rc
	 *            The &lt;code&gt;ResourceMapping&lt;/code&gt;.
	 */
	public void addAll(ResourceMapping rc) {
<span class="fc bfc" id="L275" title="All 2 branches covered.">		if (rc != null) {</span>
<span class="fc" id="L276">			colorResources.putAll(rc.colorResources);</span>
<span class="fc" id="L277">			fontResources.putAll(rc.fontResources);</span>
<span class="fc" id="L278">			stringResources.putAll(rc.stringResources);</span>
<span class="fc" id="L279">			fafResources.putAll(rc.fafResources);</span>
<span class="fc" id="L280">			szaResources.putAll(rc.szaResources);</span>
<span class="fc" id="L281">			audioResources.putAll(rc.audioResources);</span>
<span class="fc" id="L282">			videoResources.putAll(rc.videoResources);</span>
<span class="fc" id="L283">			imageResources.putAll(rc.imageResources);</span>
		}
<span class="fc" id="L285">	}</span>

	/**
	 * Returns all the mappings between IDs and &lt;code&gt;Resource&lt;/code&gt;s that are
	 * kept by this object.
	 *
	 * @return An unmodifiable &lt;code&gt;Map&lt;/code&gt;.
	 */
	public Map&lt;String, Resource&gt; getResources() {
<span class="nc" id="L294">		HashMap&lt;String, Resource&gt; result = new HashMap&lt;&gt;();</span>
<span class="nc" id="L295">		result.putAll(colorResources);</span>
<span class="nc" id="L296">		result.putAll(fontResources);</span>
<span class="nc" id="L297">		result.putAll(stringResources);</span>
<span class="nc" id="L298">		result.putAll(fafResources);</span>
<span class="nc" id="L299">		result.putAll(szaResources);</span>
<span class="nc" id="L300">		result.putAll(audioResources);</span>
<span class="nc" id="L301">		result.putAll(videoResources);</span>
<span class="nc" id="L302">		result.putAll(imageResources);</span>
<span class="nc" id="L303">		return result;</span>
	}

	/**
	 * Gets the image resources.
	 *
	 * @return the image resources
	 */
	public Map&lt;String, ImageResource&gt; getImageResources() {
<span class="nc" id="L312">		return new HashMap&lt;&gt;(imageResources);</span>
	}

	/**
	 * Contains key.
	 *
	 * @param key
	 *            the key
	 * @return true, if successful
	 */
	public boolean containsKey(String key) {
<span class="nc bnc" id="L323" title="All 6 branches missed.">		return colorResources.containsKey(key) || fontResources.containsKey(key) || stringResources.containsKey(key)</span>
<span class="nc bnc" id="L324" title="All 6 branches missed.">				|| fafResources.containsKey(key) || szaResources.containsKey(key) || audioResources.containsKey(key)</span>
<span class="nc bnc" id="L325" title="All 4 branches missed.">				|| videoResources.containsKey(key) || imageResources.containsKey(key);</span>
	}

	/**
	 * Contains color key.
	 *
	 * @param key
	 *            the key
	 * @return true, if successful
	 */
	public boolean containsColorKey(String key) {
<span class="nc" id="L336">		return colorResources.containsKey(key);</span>
	}

	/**
	 * Contains image key.
	 *
	 * @param key
	 *            the key
	 * @return true, if successful
	 */
	public boolean containsImageKey(String key) {
<span class="nc" id="L347">		return imageResources.containsKey(key);</span>
	}

	/**
	 * Gets the &lt;code&gt;Resource&lt;/code&gt; by identifier.
	 *
	 * @param key
	 *            The resource identifier.
	 * @return The &lt;code&gt;Resource&lt;/code&gt;.
	 */
	public ColorResource getColorResource(String key) {
<span class="nc" id="L358">		return colorResources.get(key);</span>
	}

	/**
	 * Gets the font resource.
	 *
	 * @param key
	 *            the key
	 * @return the font resource
	 */
	public FontResource getFontResource(String key) {
<span class="nc" id="L369">		return fontResources.get(key);</span>
	}

	/**
	 * Gets the string resource.
	 *
	 * @param key
	 *            the key
	 * @return the string resource
	 */
	public StringResource getStringResource(String key) {
<span class="nc" id="L380">		return stringResources.get(key);</span>
	}

	/**
	 * Gets the FA file resource.
	 *
	 * @param key
	 *            the key
	 * @return the FA file resource
	 */
	public FAFileResource getFAFileResource(String key) {
<span class="nc" id="L391">		return fafResources.get(key);</span>
	}

	/**
	 * Gets the SZA resource.
	 *
	 * @param key
	 *            the key
	 * @return the SZA resource
	 */
	public SZAResource getSZAResource(String key) {
<span class="nc" id="L402">		return szaResources.get(key);</span>
	}

	/**
	 * Gets the audio resource.
	 *
	 * @param key
	 *            the key
	 * @return the audio resource
	 */
	public AudioResource getAudioResource(String key) {
<span class="fc" id="L413">		return audioResources.get(key);</span>
	}

	/**
	 * Gets the video resource.
	 *
	 * @param key
	 *            the key
	 * @return the video resource
	 */
	public VideoResource getVideoResource(String key) {
<span class="nc" id="L424">		return videoResources.get(key);</span>
	}

	/**
	 * Gets the image resource.
	 *
	 * @param key
	 *            the key
	 * @return the image resource
	 */
	public ImageResource getImageResource(String key) {
<span class="nc" id="L435">		return imageResources.get(key);</span>
	}

	/**
	 * Get the image keys in this mapping with a given prefix as a list.
	 *
	 * @param prefix
	 *            The prefix to check for.
	 * @return A list of keys.
	 */
	public List&lt;String&gt; getImageKeys(String prefix) {
<span class="nc" id="L446">		return imageResources.keySet().stream().filter(k -&gt; k.startsWith(prefix)).collect(Collectors.toList());</span>
	}

	/**
	 * Get the image keys in this mapping with a given prefix as a set.
	 *
	 * @param prefix
	 *            The prefix to check for.
	 * @return The set of keys.
	 */
	public Set&lt;String&gt; getImageKeySet(String prefix) {
<span class="nc" id="L457">		return imageResources.keySet().stream().filter(k -&gt; k.startsWith(prefix)).collect(Collectors.toSet());</span>
	}

	/**
	 * Get the image keys in this mapping with a given prefix and suffix as a
	 * list.
	 *
	 * @param prefix
	 *            The prefix to check for.
	 * @param suffix
	 *            The suffix to check for.
	 * @return A list of keys.
	 */
	public List&lt;String&gt; getImageKeys(String prefix, String suffix) {
<span class="nc bnc" id="L471" title="All 4 branches missed.">		return imageResources.keySet().stream().filter(k -&gt; k.startsWith(prefix) &amp;&amp; k.endsWith(suffix))</span>
<span class="nc" id="L472">				.collect(Collectors.toList());</span>
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.7.9.201702052155</span></div></body></html>